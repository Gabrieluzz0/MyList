<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyList</title>
<link rel="icon" type="image/svg+xml"
href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üóíÔ∏è</text></svg>">
<link rel="apple-touch-icon"
href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üóíÔ∏è</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root {
  --bg-dark:#1c1c1e; --bg-light:#f2f2f7;
  --card-dark: rgba(255,255,255,0.08);
  --card-light: rgba(0,0,0,0.05);
  --primary: #0a84ff; --success: #30d158; --danger: #ff3b30;
  --text-dark:#f2f2f7; --text-light:#111;
  --muted-dark:#8e8e93; --muted-light:#555;
}

/* BASE */
body {margin:0;font-family:'SF Pro Display',-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; display:flex; flex-direction:column; min-height:100vh; box-sizing:border-box;}
body.dark { background: var(--bg-dark); color: var(--text-dark); }
body.dark .card { background: var(--card-dark); }
body.light { background: var(--bg-light); color: var(--text-light); }
body.light .card { background: var(--card-light); }

#content {flex:1; display:flex; justify-content:center; align-items:flex-start; padding:12px; overflow-y:auto; flex-direction:column; gap:16px;}

section {display:none; width:100%; max-width:1200px; margin:0 auto;}
section.active {display:block;}
.card {backdrop-filter: blur(20px); border-radius:16px; padding:16px; width:100%; max-width:360px; display:flex; flex-direction:column; overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,0.2);}
h2 {margin:0 0 12px 0;}

#listsContainer {display:flex; flex-wrap:wrap; gap:12px; justify-content:center;}
#noListsMessage {text-align:center; color: var(--muted-dark); margin-top:20px; font-size:1.1rem;}

.list-card {transition: transform 0.2s, box-shadow 0.2s;}
.list-card:hover {transform: translateY(-4px); box-shadow: 0 12px 30px rgba(0,0,0,0.25);}
.list-header {display:flex; justify-content:space-between; align-items:center; padding:8px; border-radius:12px; background: rgba(255,255,255,0.05); cursor:pointer; margin-bottom:6px;}
.list-header:hover {background: rgba(255,255,255,0.1);}
.items-container {display: none;flex-direction: column;gap: 6px;margin-top: 6px;width: 100%;}
.item {display:flex; align-items:center; justify-content:space-between; background: rgba(255,255,255,0.05); padding:8px; border-radius:12px; transition: transform 0.15s, background 0.15s;}
.item:hover {transform: translateX(4px); background: rgba(255,255,255,0.12);}
.item-left {display:flex; align-items:center; flex:1; gap:10px;}
.item-name.found {text-decoration:line-through; color:var(--success);}
.checkbox {display:flex; align-items:center; justify-content:center; width:24px; height:24px; border:2px solid var(--primary); border-radius:6px; cursor:pointer; font-weight:bold; font-size:16px; transition: background 0.2s;}
.checkbox.checked {background: var(--primary); color:#fff;}
.checkbox span {pointer-events:none;}
.item img {width:40px; height:40px; border-radius:10px; object-fit:cover; margin-right:10px;}
.drag-handle {cursor: grab; font-size:18px; margin-right:8px; user-select:none;}
.item.dragging .drag-handle {cursor: grabbing; opacity:0.6;}

progress {width:100%; height:12px; border-radius:6px; appearance:none; overflow:hidden; background: rgba(255,255,255,0.15);}
progress::-webkit-progress-value {background: var(--success); border-radius:6px; transition: width 0.5s ease-in-out;}
progress::-moz-progress-bar {background: var(--success); border-radius:6px; transition: width 0.5s ease-in-out;}
.progress-text {text-align:right; font-size:0.8rem; margin-bottom:4px;}

button {padding:10px; border:none; border-radius:12px; cursor:pointer; font-weight:600; color:#fff; background:var(--primary); margin:4px 0; transition:0.2s;}
button:hover {background:#0066cc;}
.add-object-btn {width:40px; height:40px; border-radius:50%; font-size:24px; box-shadow:0 4px 12px rgba(0,0,0,0.25); cursor:pointer; transition: transform 0.2s, background 0.2s;}
.add-object-btn:hover {transform: scale(1.1); background:#0066cc;}

.add-object-form {display:none; flex-direction:column; gap:10px; background: rgba(255,255,255,0.08); padding:14px; border-radius:14px; box-shadow:0 6px 20px rgba(0,0,0,0.2);}
.add-object-form input[type="text"], .add-object-form input[type="file"] {width:100%; padding:12px; border-radius:10px; border:none; outline:none; font-size:14px; background: rgba(255,255,255,0.12); color:inherit; transition: background 0.2s;}
.add-object-form input[type="text"]:focus {background: rgba(255,255,255,0.2);}
.add-object-form .button-group {display:flex; justify-content:space-between;}
.add-object-form button.submit-btn {background-color:var(--primary); box-shadow:0 4px 12px rgba(0,0,0,0.25);}
.add-object-form button.submit-btn:hover {background-color:#0066cc;}
.add-object-form button.close-btn {background-color:var(--danger); box-shadow:0 4px 12px rgba(0,0,0,0.25);}
.add-object-form button.close-btn:hover {background-color:#cc1f1f;}
.add-object-form {width: 100%;box-sizing: border-box;}
.add-object-form input[type="text"],
.add-object-form input[type="file"] {
  width: 100%;
  box-sizing: border-box;
}

#tabs {position:fixed; bottom:12px; left:50%; transform:translateX(-50%); display:flex; gap:12px; background: rgba(255,255,255,0.1); backdrop-filter: blur(20px); border-radius:32px; padding:8px; z-index:100;}
.tab-item {width:50px;height:50px; display:flex; justify-content:center; align-items:center; font-size:1.2rem; color:#fff; cursor:pointer; border-radius:50%; transition:0.2s;}
.tab-item:hover {transform:scale(1.1); color:var(--primary);}
.tab-item.active {background: var(--primary);}
.tab-item.active i, .tab-item:hover i {color:#fff !important;}

#listsTitleWrapper {display:flex; justify-content:center; margin:16px 0;}
#listsTitle {background-color:var(--primary); color:#fff; padding:10px 20px; border-radius:12px; font-size:24px; font-weight:600; text-align:center; box-shadow:0 4px 12px rgba(0,0,0,0.2);}
footer {position:fixed; bottom:100px; left:50%; transform:translateX(-50%); text-align:center; font-size:12px; color:#8e8e93; z-index:99; pointer-events:none;}

/* Pulsante "+" centrato */
.add-object-btn {align-self:center; margin:8px auto;}

/* Card impostazioni centrata */
#settings .card {margin:0 auto;}

/* Switch Dark Mode corretto */
.switch {position:relative; display:inline-block; width:50px; height:28px; margin-left:10px;}
.switch input {display:none;}
.slider {position:absolute; top:0; left:0; right:0; bottom:0; background:#ccc; border-radius:34px; transition:0.4s;}
.slider:before {position:absolute; content:""; height:22px; width:22px; left:3px; bottom:3px; background:#fff; border-radius:50%; transition:0.4s;}
input:checked + .slider {background-color: var(--primary);}
input:checked + .slider:before {transform:translateX(22px);}

.item button {
  width:40px;
  padding:4px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  background: rgba(255,255,255,0.05);
  transition: 0.2s;
}
.item button:hover {
  box-shadow: 0 0 0 2px var(--primary); /* contorno blu */
}

.list-delete {
  cursor: pointer;
  border-radius:6px;
  padding:4px;
  transition: 0.2s;
}
.list-delete:hover {
  box-shadow: 0 0 0 2px var(--primary);
}

.delete-btn {
  cursor: pointer;
  border-radius:6px;
  padding:4px;
  transition: 0.2s;
}
.delete-btn:hover {
  box-shadow: 0 0 0 2px var(--primary); /* contorno blu */
}


@media(max-width:500px){.card{max-width:90%;}.item img{width:32px;height:32px;}.checkbox{width:20px;height:20px;font-size:14px;margin-right:8px;}button{font-size:0.9rem;}}
</style>
</head>
<body>

<div id="content">

<section id="lists" class="active">
  <div id="listsTitleWrapper"><h1 id="listsTitle">üóíÔ∏è Liste</h1></div>
  <div id="noListsMessage">Non ci sono liste qu√¨</div>
  <div id="listsContainer"></div>
</section>

<section id="settings">
  <div class="card">
    <h2>‚öôÔ∏è Impostazioni</h2>
    <div style="display:flex;align-items:center;"><span>Dark Mode</span>
      <label class="switch"><input type="checkbox" id="darkToggle" checked><span class="slider"></span></label>
    </div>
    <hr style="border:none;height:1px;background:rgba(255,255,255,0.15);margin:16px 0;">
    <button id="exportBtn">üì§ Esporta liste</button>
    <button id="importBtn">üì• Importa liste</button>
    <input type="file" id="importFile" accept="application/json" style="display:none">
  </div>
</section>

</div>

<div id="tabs">
  <div class="tab-item active" data-tab="lists"><i class="fas fa-list"></i></div>
  <div class="tab-item" id="addListTab"><i class="fas fa-plus"></i></div>
  <div class="tab-item" data-tab="settings"><i class="fas fa-cog"></i></div>
</div>

<footer>¬© Gabrieluzz0</footer>

<script>
let data = JSON.parse(localStorage.getItem("collections")) || [];
function save() {
  localStorage.setItem("collections", JSON.stringify(data));
}




// DARK MODE
const darkToggle = document.getElementById('darkToggle');
darkToggle.checked = JSON.parse(localStorage.getItem('darkMode')||'true');
document.body.classList.toggle('dark', darkToggle.checked);
document.body.classList.toggle('light', !darkToggle.checked);
darkToggle.addEventListener('change', ()=>{
  const isDark = darkToggle.checked;
  document.body.classList.toggle('dark', isDark);
  document.body.classList.toggle('light', !isDark);
  localStorage.setItem('darkMode', isDark);
});

// TABS
document.querySelectorAll('.tab-item[data-tab]').forEach(tab=>{
  tab.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-item').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    document.querySelectorAll('section').forEach(sec=>sec.classList.remove('active'));
    document.getElementById(tab.dataset.tab).classList.add('active');
  });
});

// AGGIUNGI LISTA
document.getElementById("addListTab").addEventListener("click", () => {
  const name = prompt("Nome nuova lista:");
  if(!name) return; // niente nome, niente lista
  data.push({name:name, items:[]}); // aggiungi lista
  save(); // salva subito su localStorage
  renderLists(); // aggiorna UI
});

document.addEventListener("DOMContentLoaded", () => {
  // Legge localStorage
  data = JSON.parse(localStorage.getItem("collections")) || [];
  renderLists();
});


// EXPORT/IMPORT
document.getElementById("exportBtn").addEventListener("click", ()=>{
  const blob = new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
  const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="Liste-MyList.json"; a.click();
});
document.getElementById("importBtn").addEventListener("click", ()=>document.getElementById("importFile").click());
document.getElementById("importFile").addEventListener("change", e=>{
  const file = e.target.files[0]; if(!file) return;
  const reader = new FileReader();
  reader.onload = ev=>{
    try{
      const imported = JSON.parse(ev.target.result);
      if(!Array.isArray(imported)) throw "Formato non valido";
      if(confirm("Importare le liste? Quelle attuali verranno sovrascritte.")){
        data = imported; save(); renderLists(); alert("Liste importate con successo");
      }
    }catch{alert("File JSON non valido");}
  };
  reader.readAsText(file);
});

// RENDER LISTE
const listsContainer = document.getElementById("listsContainer");
const noListsMessage = document.getElementById("noListsMessage");

function renderLists(){
  listsContainer.innerHTML="";
  if(!data.length){ noListsMessage.style.display="block"; return; }
  noListsMessage.style.display="none";
  data.forEach((list,listIdx)=>{
    const card = document.createElement("div"); card.className="card list-card";
    const header = document.createElement("div"); header.className="list-header"; header.innerHTML=`<span>${list.name}</span><div>üóëÔ∏è</div>`;
    const itemsContainer = document.createElement("div"); itemsContainer.className="items-container";

    header.onclick=()=>{ 
      itemsContainer.style.display=itemsContainer.style.display==="flex"?"none":"flex"; 
      if(itemsContainer.style.display==="flex") renderItems(list, itemsContainer);
    };
    const listDeleteBtn = header.querySelector("div");
listDeleteBtn.classList.add("delete-btn");
listDeleteBtn.onclick = e => { 
  e.stopPropagation(); 
  if(confirm("Eliminare lista?")){ 
    data.splice(listIdx,1); save(); renderLists(); 
  } 
};

    card.append(header, itemsContainer);
    listsContainer.appendChild(card);
  });
}

header.querySelector("div").classList.add("list-delete");

// RENDER OGGETTI
function renderItems(list, container){
  container.innerHTML=""; container.style.display="flex"; container.style.flexDirection="column";

  const prog = document.createElement("progress");
  const progText = document.createElement("div"); progText.className="progress-text";
  container.append(prog, progText);

  function updateProgressBar(){
    const found = list.items.filter(i=>i.found).length;
    const total = list.items.length;
    prog.max = total||1; prog.value = found;
    progText.innerText = `${found}/${total} trovati`;
  }

  const addBtn = document.createElement("button"); addBtn.className="add-object-btn"; addBtn.innerText="+";
  const form = document.createElement("div"); form.className="add-object-form";
  const nameInput = document.createElement("input"); nameInput.type="text"; nameInput.placeholder="Nome oggetto";
  const imageInput = document.createElement("input"); imageInput.type="file"; imageInput.accept="image/*";
  const buttonGroup = document.createElement("div"); buttonGroup.className="button-group";
  const submitBtn = document.createElement("button"); submitBtn.innerText="Aggiungi"; submitBtn.className="submit-btn";
  const closeBtn = document.createElement("button"); closeBtn.innerText="Chiudi"; closeBtn.className="close-btn";
  buttonGroup.append(submitBtn, closeBtn); form.append(nameInput, imageInput, buttonGroup); form.style.display="none";
  container.append(addBtn, form);

  addBtn.onclick = ()=> form.style.display="flex";
  closeBtn.onclick = ()=> form.style.display="none";

  submitBtn.onclick = ()=>{
    if(!nameInput.value) return;
    const obj = {name:nameInput.value, found:false, img:null};
    const addItem = ()=>{ list.items.push(obj); save(); renderItems(list, container); form.style.display="none"; nameInput.value=""; imageInput.value=""; };
    if(imageInput.files[0]){
      const reader = new FileReader(); reader.onload=e=>{obj.img=e.target.result; addItem();}; reader.readAsDataURL(imageInput.files[0]);
    } else addItem();
  };

  list.items.forEach(item=>{
    const div = document.createElement("div"); div.className="item"; div.draggable=false;
    const left = document.createElement("div"); left.className="item-left";

    const handle = document.createElement("div"); handle.className="drag-handle"; handle.innerText="‚ò∞";
    const check = document.createElement("div"); check.className="checkbox"+(item.found?" checked":"");
    const checkMark = document.createElement("span"); checkMark.innerText=item.found?"‚úîÔ∏è":""; check.appendChild(checkMark);

    const nameDiv = document.createElement("div"); nameDiv.className="item-name"+(item.found?" found":""); nameDiv.innerText=item.name;

    check.onclick = ()=>{
      item.found=!item.found;
      save();
      check.classList.toggle("checked", item.found);
      checkMark.innerText=item.found?"‚úîÔ∏è":"";
      nameDiv.classList.toggle("found", item.found);
      updateProgressBar();
    };

    left.append(handle, check);
    if(item.img){ const img=document.createElement("img"); img.src=item.img; img.alt=item.name; left.appendChild(img); }
    left.appendChild(nameDiv);
    div.appendChild(left);

    const del = document.createElement("button"); del.innerText="üóëÔ∏è"; del.style.width="40px"; del.style.padding="4px";
    del.onclick=()=>{ if(confirm("Eliminare oggetto?")){ list.items.splice(list.items.indexOf(item),1); save(); renderItems(list, container); } };
    div.appendChild(del);

    let draggingEl=null;
    handle.addEventListener("mousedown", e=>div.draggable=true);
    handle.addEventListener("mouseup", e=>div.draggable=false);
    div.addEventListener("dragstart", e=>{ draggingEl=div; div.classList.add("dragging"); e.dataTransfer.effectAllowed="move"; });
    div.addEventListener("dragend", e=>{ div.classList.remove("dragging"); draggingEl=null; div.draggable=false; });
    container.addEventListener("dragover", e=>{ e.preventDefault(); if(!draggingEl) return; const after=Array.from(container.querySelectorAll(".item:not(.dragging)")).find(i=>e.clientY<i.getBoundingClientRect().top+i.offsetHeight/2); if(after) container.insertBefore(draggingEl, after); else container.appendChild(draggingEl); });
    container.addEventListener("drop", e=>{ e.preventDefault(); if(!draggingEl) return; const newIdx=Array.from(container.querySelectorAll(".item")).indexOf(draggingEl); const oldIdx=list.items.indexOf(item); if(oldIdx!==newIdx&&oldIdx>-1&&newIdx>-1){ const moved=list.items.splice(oldIdx,1)[0]; list.items.splice(newIdx,0,moved); save(); renderItems(list, container); } });

    container.appendChild(div);
  });

  updateProgressBar();
}

renderLists();
</script>

</body>
</html>
